<% layout('./layout/app') -%>
<div class="row">
    <a href="/">Go back to event page</a>
</div>

<div class="row mt-5 mb-5">
    <table class="table table-bordered  text-center">
        <thead>
            <th>EventID</th>
            <th>Name</th>
            <th>Date</th>
            <th>Venue</th>
        </thead>
        <tbody>
            <% for(let i = 0; i < eventData.length; i++) { let event = eventData[i]; %>
            <tr>
                <td style="text-align: center;">
                    <%=event.eventID%>
                </td>
                <td style="width: 200px;">
                    <%=event.name%>
                </td>
                <td>
                    <% var cdate = new Date(event.eventDate).toLocaleString('en-US', {
                                timeZone: 'America/New_York'
                            }); %>
                    <%=cdate%>
                </td>
                <td style="width: 200px;">
                    <%=' ' + event.venue.name + ', ' + event.venue.city + ', ' + event.venue.state%>
                </td>
            </tr>
            <% } %>
        </tbody>
    </table>
</div>

<div class="row">
    <table class="table table-striped table-bordered text-center">
        <thead>
            <th>Date</th>
            <th>Event</th>
            <th>TT</th>
            <th>MP</th>
            <th>ST</th>
            <th>SV</th>
        </thead>
        <tbody>
        </tbody>
        <% for(let i = 0; i< data.length; i++) { 
            for(let j = 0; j < data[i].events.length; j++) {
        %>
        <tr>
            <% if(j == 0) { %>
            <td rowspan="<%=data[i].events.length%>">
                <%=data[i].datetime.replace(', 7:00:00 PM', '').trim()%>
            </td>
            <% } %>
            <td>
                <%=data[i].events[j].eventID%>
            </td>
            <td>
                <%=(data[i].events[j].ticket != null) ? data[i].events[j].ticket.totalTickets : ''%>
            </td>
            <td>
                <%=(data[i].events[j].ticket != null) ? data[i].events[j].ticket.minTicketPrice : ''%>
            </td>
            <td>
                <%=(data[i].events[j].ticket != null) ? (i > 0  && data[i-1].events[j].ticket != null) ? data[i].events[j].ticket.soldNum - data[i-1].events[j].ticket.soldNum :  data[i].events[j].ticket.soldNum : ''%>
            </td>
            <td>
                <%=(data[i].events[j].ticket != null) ? (i > 0  && data[i-1].events[j].ticket != null) ? data[i].events[j].ticket.soldVolume - data[i-1].events[j].ticket.soldVolume :  data[i].events[j].ticket.soldVolume : ''%>
            </td>
        </tr>
        <% } } %>

        <!-- <tbody>
            <tr>
                <td></td>
                <% for(let i = 0; i< data.length; i++) { %>
                <td colspan="<%=data[i].events.length%>">
                    <%=data[i].datetime.replace(', 7:00:00 PM', '').trim()%>
                </td>
                <% } %>
            </tr>
            <tr>
                <td></td>
                <% for(let i = 0; i< data.length; i++) { 
                    for(let j = 0 ; j< data[i].events.length; j++) {    
                %>
                <td>
                    <%=data[i].events[j].eventID%>
                </td>
                <% } } %>
            </tr>
            <tr>
                <td>Total Tickets</td>
                <% for(let i = 0; i< data.length; i++) { 
                    for(let j = 0 ; j< data[i].events.length; j++) {    
                %>
                <td>
                    <%=(data[i].events[j].ticket != null) ? data[i].events[j].ticket.totalTickets : ''%>
                </td>
                <% } } %>
            </tr>
            <tr>
                <td>Min Price(2 pack)</td>
                <% for(let i = 0; i< data.length; i++) { 
                        for(let j = 0 ; j< data[i].events.length; j++) {    
                    %>
                <td>
                    <%=(data[i].events[j].ticket != null) ? data[i].events[j].ticket.minTicketPrice : ''%>
                </td>
                <% } } %>
            </tr>
            <tr>
                <td>Sold Tickets</td>
                <% for(let i = 0; i< data.length; i++) { 
                            for(let j = 0 ; j< data[i].events.length; j++) {    
                        %>
                <td>
                    <%=(data[i].events[j].ticket != null) ? (i > 0  && data[i-1].events[j].ticket != null) ? data[i].events[j].ticket.soldNum - data[i-1].events[j].ticket.soldNum :  data[i].events[j].ticket.soldNum : ''%>
                </td>
                <% } } %>
            </tr>
            <tr>
                <td>Sold Volume</td>
                <% for(let i = 0; i< data.length; i++) { 
                                for(let j = 0 ; j< data[i].events.length; j++) {    
                            %>
                <td>
                    <%=(data[i].events[j].ticket != null) ? (i > 0  && data[i-1].events[j].ticket != null) ? data[i].events[j].ticket.soldVolume - data[i-1].events[j].ticket.soldVolume :  data[i].events[j].ticket.soldVolume : ''%>
                </td>
                <% } } %>
            </tr>
        </tbody> -->
    </table>
</div>